<div class="rounded-xl bg-white shadow-sm ring-1 ring-gray-100 mb-4 dark:bg-gray-800 dark:ring-white/5">

  @if (stats().total === 0) {
    <div class="px-6 py-4">
      <p class="text-[11px] font-semibold uppercase tracking-widest text-gray-400 dark:text-gray-500 mb-0.5">Task Overview</p>
      <p class="text-sm italic text-gray-400 dark:text-gray-500">No tasks yet in {{ deptLabel() }}</p>
    </div>

  } @else {
    <div class="px-6 pt-5 pb-4">

      <!-- Header -->
      <div class="flex items-start justify-between mb-4">
        <div>
          <p class="text-[11px] font-semibold uppercase tracking-widest text-gray-400 dark:text-gray-500">Task Overview</p>
          <p class="text-sm font-semibold text-gray-700 dark:text-gray-200 mt-0.5">{{ deptLabel() }}</p>
        </div>
        <span class="inline-flex items-center gap-1.5 rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-bold text-emerald-700 ring-1 ring-emerald-200/80 dark:bg-emerald-500/10 dark:text-emerald-400 dark:ring-emerald-500/20">
          <span class="h-1.5 w-1.5 rounded-full bg-emerald-500 dark:bg-emerald-400"></span>
          {{ stats().pct }}% complete
        </span>
      </div>

      <!-- Doughnut + stat cards -->
      <div class="flex items-center gap-4">

        <!-- Doughnut -->
        <div class="relative h-24 w-24 flex-shrink-0">
          <canvas #chartCanvas></canvas>
          <div class="pointer-events-none absolute inset-0 flex flex-col items-center justify-center gap-0.5">
            <span class="text-xl font-extrabold leading-none text-gray-900 dark:text-gray-100">{{ stats().pct }}%</span>
            <span class="text-[10px] font-semibold uppercase tracking-wide text-gray-400 dark:text-gray-500">done</span>
          </div>
        </div>

        <!-- Stat cards -->
        <div class="flex flex-1 gap-2 min-w-0">
          <div class="flex flex-1 flex-col rounded-lg border-l-[3px] border-gray-300 bg-gray-50 px-3 py-2 dark:border-gray-500 dark:bg-gray-700/40">
            <span class="text-2xl font-extrabold leading-none text-gray-800 dark:text-gray-100">{{ stats().todo }}</span>
            <span class="mt-1 text-[11px] font-medium text-gray-400 dark:text-gray-500">Todo</span>
          </div>
          <div class="flex flex-1 flex-col rounded-lg border-l-[3px] border-blue-400 bg-blue-50/70 px-3 py-2 dark:border-blue-500 dark:bg-blue-900/20">
            <span class="text-2xl font-extrabold leading-none text-blue-600 dark:text-blue-300">{{ stats().inProgress }}</span>
            <span class="mt-1 text-[11px] font-medium text-blue-400 dark:text-blue-500">In Progress</span>
          </div>
          <div class="flex flex-1 flex-col rounded-lg border-l-[3px] border-emerald-400 bg-emerald-50/70 px-3 py-2 dark:border-emerald-500 dark:bg-emerald-900/20">
            <span class="text-2xl font-extrabold leading-none text-emerald-600 dark:text-emerald-400">{{ stats().done }}</span>
            <span class="mt-1 text-[11px] font-medium text-emerald-500 dark:text-emerald-500">Done</span>
          </div>
        </div>

      </div>

      <!-- Progress bar -->
      <div class="mt-4">
        <div class="flex items-center justify-between mb-1.5">
          <span class="text-[11px] font-medium text-gray-400 dark:text-gray-500">Progress</span>
          <span class="text-[11px] font-medium text-gray-400 dark:text-gray-500">{{ stats().done }} of {{ stats().total }} tasks complete</span>
        </div>
        <div class="h-1.5 w-full overflow-hidden rounded-full bg-gray-100 dark:bg-gray-700">
          <div
            class="h-full rounded-full bg-gradient-to-r from-emerald-400 to-emerald-500 transition-all duration-500"
            [style.width.%]="stats().pct">
          </div>
        </div>
      </div>

    </div>
  }

</div>
